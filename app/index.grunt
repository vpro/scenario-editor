<!doctype html>
<html ng-app="SE" ng-controller="MainController as mainCtrl" ng-init="mainCtrl.init()">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Scenario Editor</title>

	<!-- build:css styles/app.css -->
	<!--<link rel="stylesheet" href="styles/normalize.css" type="text/css" media="all" />-->
	<link rel="stylesheet" href="styles/main.css" type="text/css" media="all" />
    <link rel="stylesheet" href="styles/twitter-bootstrap/bootstrap.min.css" type="text/css" media="all" />
    <link rel="stylesheet" href="styles/style.css"/>
	<!-- endbuild -->

</head>

<body>

	<div class="container-fluid">

        <div class="row">

            <div class="col-md-6 col-md-push-2">

                <div ng-if="scenarios" id="scenario-selector">
                    <h2 class="h6">Select a scenario</h2>
                    <!-- Op de een of andere manier komt ng-model niet op de scope, dus ik geef hem hier
                        maar door aan de activateScenario method welke vervolgens het scenario inlaadt
                        en de naam van het scenario als scope.activeScenario set.

                        TODO: fix this as described in http://stackoverflow.com/a/22768720
                     -->
                    <select class="form-control" ng-model="selectedScenario" ng-change="mainCtrl.activateScenario( selectedScenario )">
                        <option value="">Select...</option>
                        <option ng-repeat="scenario in scenarios" value="{{scenario}}" ng-selected="scenario == selectedScenario">{{scenario}}</option>
                    </select>

                </div>

            </div>

        </div>
        
        <!-- Maar even ter test de scenario selector hierboven ingezet voordat onderstaande zichtbaar is, kies eerst een scenario :) -->
        <div class="scenario-editor" ng-class="{'hidden': ! activeScenario }">
        
            <div class="row" id="display" ng-class="{'closed': ! playerVisible}">
    
                <div class="col-md-2">
                    <textarea class="form-control" rows="16">
                        {{script | json}}
                    </textarea>
    
                    <div class="meta">
                        <label for="script-name">Titel</label>
                        <input id="script-name" type="text" ng-model="timeline.title" />
                    </div>
    
                    <div class="meta">
                        <label for="script-duration">Duur</label>
                        <input id="script-duration" ng-model="timeline.duration" type="number" />
                    </div>
    
                </div>
    
                <div class="col-md-10" id="player">
    
                    <div id="scenario-player-container">
                        <se-player id="scenario-player"></se-player>
                    </div>
    
                </div>
    
            </div>
    
            <div class="row bg-info" id="controls">
    
                <div class="col-md-2">
                    <button ng-show="!playerVisible" class="btn btn-primary" ng-click="mainCtrl.togglePlayerVisible()">show player</button>
                    <button ng-show="playerVisible" class="btn btn-primary" ng-click="mainCtrl.togglePlayerVisible()">hide player</button>
                </div>
    
                <div class="col-md-6">
    
                    <div class="form-inline">
    
                        <button class="btn btn-primary" ng-click="mainCtrl.sortActors()">sort</button>
    
                        <select class="form-control" ng-model="selectedActor" ng-options="actor as actor.name for actor in actorTypes"></select>
    
                        <button class="btn-primary btn" ng-class="{'disabled': !selectedActor}" ng-click="mainCtrl.addActor( selectedActor )">add {{selectedActor.name}}</button>
    
                    </div>
    
                </div>

                <div class="col-md-2 col-md-push-1">
                    <div class="btn-group">
                        <button class="btn btn-primary" ng-click="mainCtrl.previewScenario()">preview scenario</button>
                        <button class="btn btn-primary" ng-click="mainCtrl.saveScenario()">save scenario</button>
                    </div>
                </div>
            </div>

            <div class="timeline">
    
                <div class="row se-actor" ng-repeat="actor in actors track by $index">
    
                    <div class="col-md-2">

                        <div class="actor-name"
                             ng-click="actorDetailsOpen = !actorDetailsOpen">
                            details ({{actor.name}})
                            <!--{{$index}}-->
                        </div>

                        <div>
                            <input class="actor-edit-title" type="text"
                                   ng-model="actor.title"
                                   ng-trim="false">
                        </div>

                        <div>
                            <label for="actor-start-{{$index}}">start </label>
                            <input id="actor-start-{{$index}}" type="number" step="1000"
                                   ng-model="actor.start"/>
                        </div>
    
                        <div>
                            <label for="actor-duration-{{$index}}">duur  </label>
                            <input id="actor-duration-{{$index}}" type="number" step="1000"
                                   ng-model="actor.duration" />
                        </div>

                        <div ng-if="actor.src">
                            <label for="actor-src-{{$index}}">src</label>
                            <input class="actor-edit-src" id="actor-src-{{$index}}"
                                   ng-focus="mainCtrl.getAssetsForProject()"
                                   ng-model="actor.src" />
                        </div>

                        <div ng-if="actor.template.background.src">
                            <label for="actor-src-{{$index}}">src</label>
                            <input class="actor-edit-src" id="actor-src-{{$index}}"
                                   ng-focus="mainCtrl.getAssetsForProject()"
                                   ng-model="actor.template.background.src" />
                        </div>

                        <div class="actormetadetails"
                             ng-init="actorDetailsOpen = false"
                             ng-show="actorDetailsOpen" >

                            <div ng-if="actor.trigger">
                                <label for="actor-trigger-{{$index}}">trigger</label>
                                <span id="actor-trigger-{{$index}}" class="value">{{actor.trigger}}</span>
                            </div>

                            <div ng-if="actor.animationName">
                                <label for="actor-animation-{{$index}}">animation </label>
                                <span id="actor-animation-{{$index}}" class="value">{{actor.animationName}}</span>
                            </div>
    
                        </div>
    
                    </div>


    
                    <div class="col-md-10">
    
                        <div class="actor-src">
                            <div class="value" ng-if="actor.preload.url.length > 0">
                                {{actor.preload.url}}
                                <div class="actor-image" style="background-image: url('{{assetRoot}}{{actor.preload.url}}')"></div>
                            </div>
                            <div class="value"
                                 ng-if="!actor.preload.url.length && actor.preload.url.length === undefined">
                                {{actor.src}}
                            </div>
                        </div>
    
                        <div se-draggable-container class="actor-timeline">
                            <div class="actor-timeline-title">{{actor.title}}</div>
                            <span se-draggable ondrag="mainCtrl.onDrag(actor, x, y)" ondrop="mainCtrl.onDrop()" class="indicator" ng-style="{
                                left:(actor.start/timeline.duration)*100+'%',
                                width:(actor.duration/timeline.duration)*100+'%'
                            }"></span>
                        </div>

                        <div class="actor-delete"
                                ng-click="mainCtrl.deleteActor( $index )">
                            <span class="glyphicon glyphicon-remove-sign"></span>
                        </div>
    
                    </div>
    
                </div>
    
            </div>
        </div>
	</div>


    <script type="text/ng-template" id="assetSelector.html">
        <div class="asset-selector">
            Hier komt een asset selector.
        </div>
    </script>




    <script src="<%- jsserver %>/embed/configuration.js?var=vpro"></script>
    <script src="<%- jsserver %>/ext/require/2.1.17/require.min.js"></script>

	<!-- build:js js/vendor.js -->
	<script src="scripts/vendor/angularjs/angular.min.js"></script>
	<!-- endbuild -->

	<!-- build:js js/editor.js -->
	<script src="scripts/editor/app.js"></script>
	<script src="scripts/editor/constants.js"></script>
	<script src="scripts/editor/controllers/MainController.js"></script>
	<script src="scripts/editor/controllers/AssetSelectorController.js"></script>

	<script src="scripts/editor/services/ScenarioService.js"></script>
	<script src="scripts/editor/services/ActorService.js"></script>

	<script src="scripts/editor/directives/Draggable.js"></script>
	<script src="scripts/editor/directives/ScenarioPlayer.js"></script>

	<!-- endbuild -->

</body>
</html>